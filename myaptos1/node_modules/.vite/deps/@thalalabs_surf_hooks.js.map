{
  "version": 3,
  "sources": ["../../@thalalabs/surf/src/hooks/useSubmitTransaction.ts", "../../@thalalabs/surf/src/core/WalletClient.ts", "../../@thalalabs/surf/src/hooks/useWalletClient.ts"],
  "sourcesContent": ["import { useState, useRef } from 'react';\nimport { useWallet } from '@aptos-labs/wallet-adapter-react';\nimport type { EntryPayload } from '../types/index.js';\nimport { InputGenerateTransactionOptions } from '@aptos-labs/ts-sdk';\n\n// TODO: add test for this\nexport const useSubmitTransaction = () => {\n  const { connected, signAndSubmitTransaction } = useWallet();\n\n  const [isIdle, setIsIdle] = useState(true);\n  const [isLoading, setIsLoading] = useState(false);\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  const [data, setResult] = useState<any>();\n  const [error, setError] = useState<Error>();\n  const idRef = useRef<number>(0);\n\n  function reset() {\n    setIsIdle(true);\n    setIsLoading(false);\n    setResult(undefined);\n    setError(undefined);\n    idRef.current = idRef.current + 1;\n  }\n\n  async function submitTransaction(\n    payload: EntryPayload,\n    options?: InputGenerateTransactionOptions,\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  ): Promise<any> {\n    // TODO: remove this\n    if (connected === false) {\n      throw new Error('Wallet is not connected');\n    }\n\n    if (signAndSubmitTransaction === undefined) {\n      return;\n    }\n    const id = idRef.current;\n\n    if (!isIdle) {\n      throw new Error('Transaction is already in progress');\n    }\n    setIsLoading(true);\n    setIsIdle(false);\n\n    let result\n    try {\n      result = await signAndSubmitTransaction(\n        {\n          data: {\n            ...payload,\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\n            functionArguments: payload.functionArguments.map((arg: any) => {\n              if (Array.isArray(arg)) {\n                // eslint-disable-next-line @typescript-eslint/no-explicit-any\n                return arg.map((item: any) => item);\n              } else if (typeof arg === 'object') {\n                throw new Error(\n                  `a value of struct type: ${arg} is not supported`,\n                );\n              } else {\n                return arg;\n              }\n            }),\n          },\n          options: options!,\n        },\n      );\n\n      // Only update the status if the request is not stale.\n      if (id === idRef.current) {\n        setResult(result);\n        setIsLoading(false);\n      }\n    } catch (e) {\n      setError(error);\n      setIsLoading(false);\n      throw e;\n    }\n\n    return result;\n  }\n\n  return { submitTransaction, reset, isLoading, isIdle, data, error };\n};\n", "import { useWallet } from '@aptos-labs/wallet-adapter-react';\nimport { createEntryPayload } from './createEntryPayload.js';\nimport type {\n  ABIRoot,\n  ABIWalletClient,\n  EntryPayload,\n} from '../types/index.js';\n\ntype Wallet = ReturnType<typeof useWallet>;\n\nexport class WalletClient {\n  private wallet: Wallet;\n\n  constructor({ wallet }: { wallet: Wallet; }) {\n    this.wallet = wallet;\n  }\n\n  public async submitTransaction(\n    payload: EntryPayload,\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  ): Promise<any> {\n    return await this.wallet.signAndSubmitTransaction({\n      sender: this.wallet.account?.address ?? \"\",\n      data: {\n        ...payload,\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        functionArguments: payload.functionArguments.map((arg: any) => {\n          if (Array.isArray(arg)) {\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\n            return arg.map((item: any) => item);\n          } else if (typeof arg === 'object') {\n            throw new Error(`a value of struct type: ${arg} is not supported`);\n          } else {\n            return arg;\n          }\n        }),\n      }\n    });\n  }\n\n  public useABI<T extends ABIRoot>(abi: T) {\n    return new Proxy({} as ABIWalletClient<T>, {\n      get: (_, prop) => {\n        const functionName = prop.toString();\n        return (...args) => {\n          const payload = createEntryPayload(abi, {\n            function: functionName,\n            typeArguments: args[0].type_arguments,\n            functionArguments: args[0].arguments,\n          });\n          return this.submitTransaction(payload);\n        };\n      },\n    });\n  }\n}\n", "import { useWallet } from '@aptos-labs/wallet-adapter-react';\nimport { WalletClient } from '../core/WalletClient.js';\n\nexport const useWalletClient = () => {\n  const wallet = useWallet();\n  return {\n    connected: wallet.connected,\n    client: wallet.connected\n      ? new WalletClient({ wallet, })\n      : undefined,\n  };\n};\n"],
  "mappings": ";;;;;;;;;;;;;;;;;AAAA,mBAAiC;AAM1B,IAAM,uBAAuB,MAAK;AACvC,QAAM,EAAE,WAAW,yBAAwB,IAAK,UAAS;AAEzD,QAAM,CAAC,QAAQ,SAAS,QAAI,uBAAS,IAAI;AACzC,QAAM,CAAC,WAAW,YAAY,QAAI,uBAAS,KAAK;AAEhD,QAAM,CAAC,MAAM,SAAS,QAAI,uBAAQ;AAClC,QAAM,CAAC,OAAO,QAAQ,QAAI,uBAAQ;AAClC,QAAM,YAAQ,qBAAe,CAAC;AAE9B,WAAS,QAAK;AACZ,cAAU,IAAI;AACd,iBAAa,KAAK;AAClB,cAAU,MAAS;AACnB,aAAS,MAAS;AAClB,UAAM,UAAU,MAAM,UAAU;EAClC;AAEA,iBAAe,kBACb,SACA,SAAyC;AAIzC,QAAI,cAAc,OAAO;AACvB,YAAM,IAAI,MAAM,yBAAyB;;AAG3C,QAAI,6BAA6B,QAAW;AAC1C;;AAEF,UAAM,KAAK,MAAM;AAEjB,QAAI,CAAC,QAAQ;AACX,YAAM,IAAI,MAAM,oCAAoC;;AAEtD,iBAAa,IAAI;AACjB,cAAU,KAAK;AAEf,QAAI;AACJ,QAAI;AACF,eAAS,MAAM,yBACb;QACE,MAAM;UACJ,GAAG;UAEH,mBAAmB,QAAQ,kBAAkB,IAAI,CAAC,QAAY;AAC5D,gBAAI,MAAM,QAAQ,GAAG,GAAG;AAEtB,qBAAO,IAAI,IAAI,CAAC,SAAc,IAAI;uBACzB,OAAO,QAAQ,UAAU;AAClC,oBAAM,IAAI,MACR,2BAA2B,GAAG,mBAAmB;mBAE9C;AACL,qBAAO;;UAEX,CAAC;;QAEH;OACD;AAIH,UAAI,OAAO,MAAM,SAAS;AACxB,kBAAU,MAAM;AAChB,qBAAa,KAAK;;aAEb,GAAG;AACV,eAAS,KAAK;AACd,mBAAa,KAAK;AAClB,YAAM;;AAGR,WAAO;EACT;AAEA,SAAO,EAAE,mBAAmB,OAAO,WAAW,QAAQ,MAAM,MAAK;AACnE;;;AC1EM,IAAO,eAAP,MAAmB;EAGvB,YAAY,EAAE,OAAM,GAAuB;AAFnC,WAAA,eAAA,MAAA,UAAA;;;;;;AAGN,SAAK,SAAS;EAChB;EAEO,MAAM,kBACX,SAAqB;AAjBzB;AAoBI,WAAO,MAAM,KAAK,OAAO,yBAAyB;MAChD,UAAQ,UAAK,OAAO,YAAZ,mBAAqB,YAAW;MACxC,MAAM;QACJ,GAAG;QAEH,mBAAmB,QAAQ,kBAAkB,IAAI,CAAC,QAAY;AAC5D,cAAI,MAAM,QAAQ,GAAG,GAAG;AAEtB,mBAAO,IAAI,IAAI,CAAC,SAAc,IAAI;qBACzB,OAAO,QAAQ,UAAU;AAClC,kBAAM,IAAI,MAAM,2BAA2B,GAAG,mBAAmB;iBAC5D;AACL,mBAAO;;QAEX,CAAC;;KAEJ;EACH;EAEO,OAA0B,KAAM;AACrC,WAAO,IAAI,MAAM,CAAA,GAA0B;MACzC,KAAK,CAAC,GAAG,SAAQ;AACf,cAAM,eAAe,KAAK,SAAQ;AAClC,eAAO,IAAI,SAAQ;AACjB,gBAAM,UAAU,mBAAmB,KAAK;YACtC,UAAU;YACV,eAAe,KAAK,CAAC,EAAE;YACvB,mBAAmB,KAAK,CAAC,EAAE;WAC5B;AACD,iBAAO,KAAK,kBAAkB,OAAO;QACvC;MACF;KACD;EACH;;;;ACnDK,IAAM,kBAAkB,MAAK;AAClC,QAAM,SAAS,UAAS;AACxB,SAAO;IACL,WAAW,OAAO;IAClB,QAAQ,OAAO,YACX,IAAI,aAAa,EAAE,OAAM,CAAG,IAC5B;;AAER;",
  "names": []
}
